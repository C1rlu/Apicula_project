[gd_scene load_steps=16 format=3 uid="uid://cjgga2j23u4wl"]

[ext_resource type="Script" path="res://10_BOARD/Behaviour/Movable_paper.tres.gd" id="1_lq0r8"]
[ext_resource type="Script" path="res://10_BOARD/Behaviour/Apply_pos_anim.gd" id="2_6a7ya"]

[sub_resource type="GDScript" id="GDScript_pvnvf"]
script/source = "extends Node

@export var _legend : String

func set_legend(legend : String):
	_legend = legend	

func get_legend():
	return _legend 
"

[sub_resource type="Gradient" id="Gradient_l6wlh"]
offsets = PackedFloat32Array(0, 0.064, 0.202667, 1)
colors = PackedColorArray(1, 1, 1, 1, 0.456, 0.456, 0.456, 1, 0.31959, 0.31959, 0.31959, 1, 0, 0, 0, 1)

[sub_resource type="GradientTexture2D" id="GradientTexture2D_hrvov"]
gradient = SubResource("Gradient_l6wlh")
fill = 2
fill_from = Vector2(0.5, 0.5)

[sub_resource type="VisualShaderNodeTexture" id="VisualShaderNodeTexture_fqa7o"]
texture = SubResource("GradientTexture2D_hrvov")

[sub_resource type="VisualShaderNodeFloatConstant" id="VisualShaderNodeFloatConstant_lp4nv"]
constant = 0.4

[sub_resource type="VisualShaderNodeExpression" id="VisualShaderNodeExpression_wh6q8"]
size = Vector2(724.789, 654.559)
expression = "const float DITHER_THRESHOLDS[16] ={
		1.0 / 17.0, 9.0 / 17.0, 3.0 / 17.0, 11.0 / 17.0,
		13.0 / 17.0, 5.0 / 17.0, 15.0 / 17.0, 7.0 / 17.0,
		4.0 / 17.0, 12.0 / 17.0, 2.0 / 17.0, 10.0 / 17.0,
		16.0 / 17.0, 8.0 / 17.0, 14.0 / 17.0, 6.0 / 17.0
	};
	
vec2 uv = FRAGCOORD.xy * Size;
int index = (int(uv.x) % 4) * 4 + int(uv.y) % 4;
Dither_Node = In - DITHER_THRESHOLDS[index];"

[sub_resource type="VisualShaderNodeStep" id="VisualShaderNodeStep_3gxbg"]

[sub_resource type="VisualShaderNodeFloatParameter" id="VisualShaderNodeFloatParameter_gs1mi"]
parameter_name = "Opacity"

[sub_resource type="VisualShader" id="VisualShader_jh6cd"]
code = "shader_type canvas_item;
render_mode blend_mix;

uniform sampler2D tex_frg_15;
uniform float Opacity;



void fragment() {
// Texture2D:15
	vec4 n_out15p0 = texture(tex_frg_15, UV);


// FloatParameter:20
	float n_out20p0 = Opacity;


// FloatConstant:16
	float n_out16p0 = 0.400000;


	float n_out18p0;
// Expression:18
	n_out18p0 = 0.0;
	{
		const float DITHER_THRESHOLDS[16] ={
				1.0 / 17.0, 9.0 / 17.0, 3.0 / 17.0, 11.0 / 17.0,
				13.0 / 17.0, 5.0 / 17.0, 15.0 / 17.0, 7.0 / 17.0,
				4.0 / 17.0, 12.0 / 17.0, 2.0 / 17.0, 10.0 / 17.0,
				16.0 / 17.0, 8.0 / 17.0, 14.0 / 17.0, 6.0 / 17.0
			};
			
		vec2 uv = FRAGCOORD.xy * n_out16p0;
		int index = (int(uv.x) % 4) * 4 + int(uv.y) % 4;
		n_out18p0 = n_out20p0 - DITHER_THRESHOLDS[index];
	}


// Step:19
	float n_out19p0 = step(n_out15p0.x, n_out18p0);


// Output:0
	COLOR.a = n_out19p0;


}
"
graph_offset = Vector2(-567.79, 89.0975)
mode = 1
flags/light_only = false
nodes/fragment/0/position = Vector2(1060, 180)
nodes/fragment/15/node = SubResource("VisualShaderNodeTexture_fqa7o")
nodes/fragment/15/position = Vector2(260, 180)
nodes/fragment/16/node = SubResource("VisualShaderNodeFloatConstant_lp4nv")
nodes/fragment/16/position = Vector2(-220, 520)
nodes/fragment/18/node = SubResource("VisualShaderNodeExpression_wh6q8")
nodes/fragment/18/position = Vector2(100, 480)
nodes/fragment/18/size = Vector2(724.789, 654.559)
nodes/fragment/18/input_ports = "0,0,In;1,0,Size;"
nodes/fragment/18/output_ports = "0,0,Dither_Node;"
nodes/fragment/18/expression = "const float DITHER_THRESHOLDS[16] ={
		1.0 / 17.0, 9.0 / 17.0, 3.0 / 17.0, 11.0 / 17.0,
		13.0 / 17.0, 5.0 / 17.0, 15.0 / 17.0, 7.0 / 17.0,
		4.0 / 17.0, 12.0 / 17.0, 2.0 / 17.0, 10.0 / 17.0,
		16.0 / 17.0, 8.0 / 17.0, 14.0 / 17.0, 6.0 / 17.0
	};
	
vec2 uv = FRAGCOORD.xy * Size;
int index = (int(uv.x) % 4) * 4 + int(uv.y) % 4;
Dither_Node = In - DITHER_THRESHOLDS[index];"
nodes/fragment/19/node = SubResource("VisualShaderNodeStep_3gxbg")
nodes/fragment/19/position = Vector2(760, 180)
nodes/fragment/20/node = SubResource("VisualShaderNodeFloatParameter_gs1mi")
nodes/fragment/20/position = Vector2(-540, 300)
nodes/fragment/connections = PackedInt32Array(16, 0, 18, 1, 18, 0, 19, 1, 19, 0, 0, 1, 15, 0, 19, 0, 20, 0, 18, 0)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_mae6i"]
resource_local_to_scene = true
shader = SubResource("VisualShader_jh6cd")
shader_parameter/Opacity = 0.25

[sub_resource type="GDScript" id="GDScript_to2gn"]
script/source = "extends Node
@onready var photo_square_prefabs = $\"../..\"

@onready var burn = $\"../../BURN\"
@onready var take_object = $\"../../Take_object\"


var t 
var _active
signal burn_signal
func _ready():
	_global_datas._show_object_legend.connect(_zoom)

func _zoom(condition,value):
	
		_active = condition
	
func _destroy(): 
	
	if _global_datas.Player_InSubScene:
		return
	burn_signal.emit()	
	photo_square_prefabs.queue_free()
	
func _in_zone():
	
	if _active:
		return
	if _global_datas.Player_InSubScene:
		return
	
	_fade_in()
	take_object.kill_on_pos = true

func _out_zone():

	_fade_out()
	take_object.kill_on_pos = false

func _fade_in():
	
	burn.visible = true
		
func _fade_out():
		
	burn.visible = false
	


"

[sub_resource type="GDScript" id="GDScript_axg7a"]
script/source = "extends Node

signal  move_behind


func _move_behind():
	move_behind.emit()
"

[sub_resource type="RectangleShape2D" id="RectangleShape2D_34v14"]
size = Vector2(320, 429)

[node name="Start_note" type="Node2D"]
rotation = -1.5708

[node name="Take_object" type="Node" parent="."]
script = ExtResource("1_lq0r8")
scale_in_loupe = 1.5
object_center_marge = Vector2(153, 190)

[node name="Apply_pos_anim" type="Node" parent="."]
script = ExtResource("2_6a7ya")

[node name="Legend" type="Node" parent="."]
script = SubResource("GDScript_pvnvf")

[node name="ColorRect" type="ColorRect" parent="."]
offset_left = -108.0
offset_top = -191.0
offset_right = 141.0
offset_bottom = 217.0
color = Color(0.519531, 0.484375, 0.421875, 1)

[node name="BURN" type="ColorRect" parent="."]
visible = false
light_mask = 3
material = SubResource("ShaderMaterial_mae6i")
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -107.0
offset_top = -191.0
offset_right = 141.0
offset_bottom = 218.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2
color = Color(1, 0.831373, 0.568627, 1)

[node name="Label" type="Label" parent="."]
offset_left = 139.0
offset_top = -190.0
offset_right = 546.0
offset_bottom = 56.0
rotation = 1.57079
theme_override_colors/font_color = Color(0.301961, 0.278431, 0.235294, 1)
theme_override_font_sizes/font_size = 30
text = "\" Rendez-vous at the lighthouse \""
horizontal_alignment = 1
vertical_alignment = 1
autowrap_mode = 3

[node name="Label2" type="Label" parent="."]
offset_left = -38.0
offset_top = 70.0
offset_right = 108.0
offset_bottom = 137.0
rotation = 1.57079
theme_override_colors/font_color = Color(0.301961, 0.278431, 0.235294, 1)
theme_override_font_sizes/font_size = 25
text = "M.Apart"
horizontal_alignment = 1
vertical_alignment = 1
autowrap_mode = 3

[node name="Area2D" type="Area2D" parent="."]

[node name="I_Burn" type="Node" parent="Area2D"]
script = SubResource("GDScript_to2gn")

[node name="Apply_pos_behind" type="Node" parent="Area2D"]
script = SubResource("GDScript_axg7a")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Area2D"]
visible = false
position = Vector2(10, -17.5)
shape = SubResource("RectangleShape2D_34v14")

[connection signal="mouse_entered" from="Area2D" to="Take_object" method="_on_area_2d_mouse_entered"]
[connection signal="mouse_exited" from="Area2D" to="Take_object" method="_on_area_2d_mouse_exited"]
[connection signal="move_behind" from="Area2D/Apply_pos_behind" to="Apply_pos_anim" method="_on_apply_pos_behind_move_behind"]
