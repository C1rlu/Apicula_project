[gd_scene load_steps=12 format=3 uid="uid://dnstgf2nfe32d"]

[ext_resource type="Script" path="res://10_BOARD/Behaviour/Movable_paper.tres.gd" id="1_bl54j"]
[ext_resource type="Texture2D" uid="uid://cc2d66pnwhxyr" path="res://10_BOARD/Loupe/Loupe_2d.png" id="1_pvml1"]
[ext_resource type="Script" path="res://10_BOARD/Behaviour/Apply_pos_anim.gd" id="2_bfvkp"]

[sub_resource type="Shader" id="Shader_jemkw"]
code = "shader_type canvas_item;

uniform sampler2D screen: hint_screen_texture;
uniform float magFactor = 2.0;
varying vec2 center;

void vertex(){
	center = (CANVAS_MATRIX * MODEL_MATRIX[3]).xy;
}

float circle(vec2 position, float radius, float feather)
{
	return smoothstep(radius, radius + feather, length(position - vec2(0.5)));
}

void fragment(){
	vec2 centerUV = center * SCREEN_PIXEL_SIZE;
	vec2 normalizedCoord = (SCREEN_UV - centerUV) / magFactor + centerUV;
	
    float distanceToCenter = distance(normalizedCoord, centerUV);
    float alpha = smoothstep(0.0, 1.0, 1.0 - distanceToCenter);
	
	vec4 texColor = texture(screen, normalizedCoord);
	COLOR = texture(screen, (SCREEN_UV - centerUV) / magFactor + centerUV);
	COLOR.a = 1.0  - circle(UV, 0.5, 0.005);
}"

[sub_resource type="ShaderMaterial" id="ShaderMaterial_p7l6e"]
shader = SubResource("Shader_jemkw")
shader_parameter/magFactor = 4.0

[sub_resource type="VisualShaderNodeColorParameter" id="VisualShaderNodeColorParameter_jih5b"]
parameter_name = "ColorParameter"

[sub_resource type="VisualShader" id="VisualShader_dv0fd"]
code = "shader_type canvas_item;
render_mode blend_mix;

uniform vec4 ColorParameter : source_color;



void fragment() {
// ColorParameter:2
	vec4 n_out2p0 = ColorParameter;


// Output:0
	COLOR.rgb = vec3(n_out2p0.xyz);


}
"
mode = 1
flags/light_only = false
nodes/fragment/2/node = SubResource("VisualShaderNodeColorParameter_jih5b")
nodes/fragment/2/position = Vector2(0, 160)
nodes/fragment/connections = PackedInt32Array(2, 0, 0, 0)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_w8xke"]
shader = SubResource("VisualShader_dv0fd")
shader_parameter/ColorParameter = Color(0.356863, 0.313726, 0.203922, 1)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_uu1br"]
shader = SubResource("VisualShader_dv0fd")
shader_parameter/ColorParameter = Color(0.196944, 0.170948, 0.099966, 1)

[sub_resource type="GDScript" id="GDScript_ygg8l"]
script/source = "extends Node

signal  move_behind


func _move_behind():
	move_behind.emit()
"

[sub_resource type="RectangleShape2D" id="RectangleShape2D_x2a12"]
size = Vector2(56.9186, 161.589)

[node name="Loupe" type="Node2D"]
position = Vector2(1715, 798)
rotation = -0.322476

[node name="Take_object" type="Node" parent="."]
script = ExtResource("1_bl54j")

[node name="Apply_pos_anim" type="Node" parent="."]
script = ExtResource("2_bfvkp")

[node name="Timer" type="Timer" parent="Apply_pos_anim"]
wait_time = 0.25
one_shot = true

[node name="ColorRect" type="ColorRect" parent="."]
material = SubResource("ShaderMaterial_p7l6e")
offset_left = -101.668
offset_top = -216.374
offset_right = 298.331
offset_bottom = 183.626
scale = Vector2(0.50585, 0.50585)

[node name="shadow" type="TextureRect" parent="."]
visible = false
material = SubResource("ShaderMaterial_w8xke")
offset_left = -223.105
offset_top = -209.505
offset_right = 800.895
offset_bottom = 814.495
scale = Vector2(0.408604, 0.408604)
texture = ExtResource("1_pvml1")

[node name="TextureRect" type="TextureRect" parent="."]
material = SubResource("ShaderMaterial_w8xke")
offset_left = -207.596
offset_top = -227.518
offset_right = 816.404
offset_bottom = 796.482
scale = Vector2(0.408604, 0.408604)
texture = ExtResource("1_pvml1")

[node name="TextureRect2" type="TextureRect" parent="."]
material = SubResource("ShaderMaterial_uu1br")
offset_left = -221.504
offset_top = -236.383
offset_right = 802.496
offset_bottom = 787.617
scale = Vector2(0.436207, 0.436207)
texture = ExtResource("1_pvml1")

[node name="ColorRect2" type="ColorRect" parent="."]
offset_left = -19.6167
offset_top = 14.5323
offset_right = 20.3833
offset_bottom = 167.277
mouse_filter = 2
color = Color(0.482353, 0.431373, 0.290196, 1)

[node name="Area2D" type="Area2D" parent="."]
position = Vector2(127, 0)

[node name="Apply_pos_behind" type="Node" parent="Area2D"]
script = SubResource("GDScript_ygg8l")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Area2D"]
position = Vector2(-126.443, 91.5487)
shape = SubResource("RectangleShape2D_x2a12")

[connection signal="pos_anim" from="Take_object" to="Apply_pos_anim" method="_on_take_object_pos_anim"]
[connection signal="timeout" from="Apply_pos_anim/Timer" to="Apply_pos_anim" method="_on_timer_timeout"]
[connection signal="mouse_entered" from="Area2D" to="Take_object" method="_on_area_2d_mouse_entered"]
[connection signal="mouse_exited" from="Area2D" to="Take_object" method="_on_area_2d_mouse_exited"]
[connection signal="move_behind" from="Area2D/Apply_pos_behind" to="Apply_pos_anim" method="_on_apply_pos_behind_move_behind"]
